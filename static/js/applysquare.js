window.debug=(function(){var i=this,b=Array.prototype.slice,d=i.console,h={},f,g,m=2,c=["error","warn","info","debug","log"],l="assert clear count dir dirxml exception group groupCollapsed groupEnd profile profileEnd table time timeEnd trace".split(" "),j=l.length,a=[];while(--j>=0){(function(n){h[n]=function(){try{m!==0&&d&&d[n]&&d[n].apply(d,arguments)}catch(o){}}})(l[j])}j=c.length;while(--j>=0){(function(n,o){h[o]=function(){var q=b.call(arguments),p=[o].concat(q);a.push(p);e(p);if(!d||!k(n)){return}d.firebug?d[o].apply(i,q):d[o]?d[o](q):d.log(q)}})(j,c[j])}function e(n){if(f&&(g||!d||!d.log)){f.apply(i,n)}}h.setLevel=function(n){m=typeof n==="number"?n:9};function k(n){return m>0?m>n:c.length+m<=n}h.setCallback=function(){var o=b.call(arguments),n=a.length,p=n;f=o.shift()||null;g=typeof o[0]==="boolean"?o.shift():false;p-=typeof o[0]==="number"?o.shift():n;while(p<n){e(a[p++])}};return h})();(function(a){a.extend(a.fn,{livequery:function(f,e,d){var c=this,g;if(a.isFunction(f)){d=e,e=f,f=undefined}a.each(a.livequery.queries,function(h,j){if(c.selector==j.selector&&c.context==j.context&&f==j.type&&(!e||e.$lqguid==j.fn.$lqguid)&&(!d||d.$lqguid==j.fn2.$lqguid)){return(g=j)&&false}});g=g||new a.livequery(this.selector,this.context,f,e,d);g.stopped=false;g.run();return this},expire:function(f,e,d){var c=this;if(a.isFunction(f)){d=e,e=f,f=undefined}a.each(a.livequery.queries,function(g,h){if(c.selector==h.selector&&c.context==h.context&&(!f||f==h.type)&&(!e||e.$lqguid==h.fn.$lqguid)&&(!d||d.$lqguid==h.fn2.$lqguid)&&!this.stopped){a.livequery.stop(h.id)}});return this}});a.livequery=function(c,e,g,f,d){this.selector=c;this.context=e||document;this.type=g;this.fn=f;this.fn2=d;this.elements=[];this.stopped=false;this.id=a.livequery.queries.push(this)-1;f.$lqguid=f.$lqguid||a.livequery.guid++;if(d){d.$lqguid=d.$lqguid||a.livequery.guid++}return this};a.livequery.prototype={stop:function(){var c=this;if(this.type){this.elements.unbind(this.type,this.fn)}else{if(this.fn2){this.elements.each(function(d,e){c.fn2.apply(e)})}}this.elements=[];this.stopped=true},run:function(){if(this.stopped){return}var e=this;var f=this.elements,d=a(this.selector,this.context),c=d.not(f);this.elements=d;if(this.type){c.bind(this.type,this.fn);if(f.length>0){a.each(f,function(g,h){if(a.inArray(h,d)<0){a.event.remove(h,e.type,e.fn)}})}}else{c.each(function(){e.fn.apply(this)});if(this.fn2&&f.length>0){a.each(f,function(g,h){if(a.inArray(h,d)<0){e.fn2.apply(h)}})}}}};a.extend(a.livequery,{guid:0,queries:[],queue:[],running:false,timeout:null,checkQueue:function(){if(a.livequery.running&&a.livequery.queue.length){var c=a.livequery.queue.length;while(c--){a.livequery.queries[a.livequery.queue.shift()].run()}}},pause:function(){a.livequery.running=false},play:function(){a.livequery.running=true;a.livequery.run()},registerPlugin:function(){a.each(arguments,function(d,e){if(!a.fn[e]){return}var c=a.fn[e];a.fn[e]=function(){var f=c.apply(this,arguments);a.livequery.run();return f}})},run:function(c){if(c!=undefined){if(a.inArray(c,a.livequery.queue)<0){a.livequery.queue.push(c)}}else{a.each(a.livequery.queries,function(d){if(a.inArray(d,a.livequery.queue)<0){a.livequery.queue.push(d)}})}if(a.livequery.timeout){clearTimeout(a.livequery.timeout)}a.livequery.timeout=setTimeout(a.livequery.checkQueue,20)},stop:function(c){if(c!=undefined){a.livequery.queries[c].stop()}else{a.each(a.livequery.queries,function(d){a.livequery.queries[d].stop()})}}});a.livequery.registerPlugin("append","prepend","after","before","wrap","attr","removeAttr","addClass","removeClass","toggleClass","empty","remove");a(function(){a.livequery.play()});var b=a.prototype.init;a.prototype.init=function(d,f){var e=b.apply(this,arguments);if(d&&d.selector){e.context=d.context,e.selector=d.selector}if(typeof d=="string"){e.context=f||document,e.selector=d}return e};a.prototype.init.prototype=a.prototype})(jQuery);(function(){function c(){}var l=c.prototype;var v=this;var x=v.EventEmitter;function h(z,A){var y=z.length;while(y--){if(z[y].listener===A){return y}}return -1}function j(y){return function z(){return this[y].apply(this,arguments)}}l.getListeners=function t(y){var B=this._getEvents();var z;var A;if(typeof y==="object"){z={};for(A in B){if(B.hasOwnProperty(A)&&y.test(A)){z[A]=B[A]}}}else{z=B[y]||(B[y]=[])}return z};l.flattenListeners=function r(A){var y=[];var z;for(z=0;z<A.length;z+=1){y.push(A[z].listener)}return y};l.getListenersAsObject=function e(y){var A=this.getListeners(y);var z;if(A instanceof Array){z={};z[y]=A}return z||A};l.addListener=function f(y,B){var A=this.getListenersAsObject(y);var C=typeof B==="object";var z;for(z in A){if(A.hasOwnProperty(z)&&h(A[z],B)===-1){A[z].push(C?B:{listener:B,once:false})}}return this};l.on=j("addListener");l.addOnceListener=function a(y,z){return this.addListener(y,{listener:z,once:true})};l.once=j("addOnceListener");l.defineEvent=function p(y){this.getListeners(y);return this};l.defineEvents=function q(y){for(var z=0;z<y.length;z+=1){this.defineEvent(y[z])}return this};l.removeListener=function b(y,C){var B=this.getListenersAsObject(y);var z;var A;for(A in B){if(B.hasOwnProperty(A)){z=h(B[A],C);if(z!==-1){B[A].splice(z,1)}}}return this};l.off=j("removeListener");l.addListeners=function m(y,z){return this.manipulateListeners(false,y,z)};l.removeListeners=function s(y,z){return this.manipulateListeners(true,y,z)};l.manipulateListeners=function g(z,A,C){var B;var D;var E=z?this.removeListener:this.addListener;var y=z?this.removeListeners:this.addListeners;if(typeof A==="object"&&!(A instanceof RegExp)){for(B in A){if(A.hasOwnProperty(B)&&(D=A[B])){if(typeof D==="function"){E.call(this,B,D)}else{y.call(this,B,D)}}}}else{B=C.length;while(B--){E.call(this,A,C[B])}}return this};l.removeEvent=function o(y){var B=typeof y;var A=this._getEvents();var z;if(B==="string"){delete A[y]}else{if(B==="object"){for(z in A){if(A.hasOwnProperty(z)&&y.test(z)){delete A[z]}}}else{delete this._events}}return this};l.removeAllListeners=j("removeEvent");l.emitEvent=function u(y,A){var D=this.getListenersAsObject(y);var E;var C;var B;var z;for(B in D){if(D.hasOwnProperty(B)){C=D[B].length;while(C--){E=D[B][C];if(E.once===true){this.removeListener(y,E.listener)}z=E.listener.apply(this,A||[]);if(z===this._getOnceReturnValue()){this.removeListener(y,E.listener)}}}}return this};l.trigger=j("emitEvent");l.emit=function k(y){var z=Array.prototype.slice.call(arguments,1);return this.emitEvent(y,z)};l.setOnceReturnValue=function i(y){this._onceReturnValue=y;return this};l._getOnceReturnValue=function n(){if(this.hasOwnProperty("_onceReturnValue")){return this._onceReturnValue}else{return true}};l._getEvents=function d(){return this._events||(this._events={})};c.noConflict=function w(){v.EventEmitter=x;return c};if(typeof define==="function"&&define.amd){define("eventEmitter/EventEmitter",[],function(){return c})}else{if(typeof module==="object"&&module.exports){module.exports=c}else{this.EventEmitter=c}}}.call(this));(function(e){var b=document.documentElement;var f=function(){};function a(h){var g=e.event;g.target=g.target||g.srcElement||h;return g}if(b.addEventListener){f=function(i,h,g){i.addEventListener(h,g,false)}}else{if(b.attachEvent){f=function(i,h,g){i[h+g]=g.handleEvent?function(){var j=a(i);g.handleEvent.call(g,j)}:function(){var j=a(i);g.call(i,j)};i.attachEvent("on"+h,i[h+g])}}}var d=function(){};if(b.removeEventListener){d=function(i,h,g){i.removeEventListener(h,g,false)}}else{if(b.detachEvent){d=function(j,h,g){j.detachEvent("on"+h,j[h+g]);try{delete j[h+g]}catch(i){j[h+g]=undefined}}}}var c={bind:f,unbind:d};if(typeof define==="function"&&define.amd){define("eventie/eventie",c)}else{e.eventie=c}})(this);(function(b,a){if(typeof define==="function"&&define.amd){define(["eventEmitter/EventEmitter","eventie/eventie"],function(d,c){return a(b,d,c)})}else{if(typeof exports==="object"){module.exports=a(b,require("eventEmitter"),require("eventie"))}else{b.imagesLoaded=a(b,b.EventEmitter,b.eventie)}}})(this,function factory(i,m,l){var g=i.jQuery;var e=i.console;var c=typeof e!=="undefined";function j(p,o){for(var q in o){p[q]=o[q]}return p}var n=Object.prototype.toString;function h(o){return n.call(o)==="[object Array]"}function d(r){var q=[];if(h(r)){q=r}else{if(typeof r.length==="number"){for(var p=0,o=r.length;p<o;p++){q.push(r[p])}}else{q.push(r)}}return q}function f(q,p,o){if(!(this instanceof f)){return new f(q,p)}if(typeof q==="string"){q=document.querySelectorAll(q)}this.elements=d(q);this.options=j({},this.options);if(typeof p==="function"){o=p}else{j(this.options,p)}if(o){this.on("always",o)}this.getImages();if(g){this.jqDeferred=new g.Deferred()}var r=this;setTimeout(function(){r.check()})}f.prototype=new m();f.prototype.options={};f.prototype.getImages=function(){this.images=[];for(var r=0,o=this.elements.length;r<o;r++){var s=this.elements[r];if(s.nodeName==="IMG"){this.addImage(s)}var u=s.querySelectorAll("img");for(var q=0,t=u.length;q<t;q++){var p=u[q];this.addImage(p)}}};f.prototype.addImage=function(o){var p=new k(o);this.images.push(p)};f.prototype.check=function(){var t=this;var p=0;var r=this.images.length;this.hasAnyBroken=false;if(!r){this.complete();return}function q(v,u){if(t.options.debug&&c){e.log("confirm",v,u)}t.progress(v);p++;if(p===r){t.complete()}return true}for(var o=0;o<r;o++){var s=this.images[o];s.on("confirm",q);s.check()}};f.prototype.progress=function(o){this.hasAnyBroken=this.hasAnyBroken||!o.isLoaded;var p=this;setTimeout(function(){p.emit("progress",p,o);if(p.jqDeferred&&p.jqDeferred.notify){p.jqDeferred.notify(p,o)}})};f.prototype.complete=function(){var o=this.hasAnyBroken?"fail":"done";this.isComplete=true;var p=this;setTimeout(function(){p.emit(o,p);p.emit("always",p);if(p.jqDeferred){var q=p.hasAnyBroken?"reject":"resolve";p.jqDeferred[q](p)}})};if(g){g.fn.imagesLoaded=function(p,q){var o=new f(this,p,q);return o.jqDeferred.promise(g(this))}}function k(o){this.img=o}k.prototype=new m();k.prototype.check=function(){var o=b[this.img.src]||new a(this.img.src);if(o.isConfirmed){this.confirm(o.isLoaded,"cached was confirmed");return}if(this.img.complete&&this.img.naturalWidth!==undefined){this.confirm(this.img.naturalWidth!==0,"naturalWidth");return}var p=this;o.on("confirm",function(q,r){p.confirm(q.isLoaded,r);return true});o.check()};k.prototype.confirm=function(o,p){this.isLoaded=o;this.emit("confirm",this,p)};var b={};function a(o){this.src=o;b[o]=this}a.prototype=new m();a.prototype.check=function(){if(this.isChecked){return}var o=new Image();l.bind(o,"load",this);l.bind(o,"error",this);o.src=this.src;this.isChecked=true};a.prototype.handleEvent=function(o){var p="on"+o.type;if(this[p]){this[p](o)}};a.prototype.onload=function(o){this.confirm(true,"onload");this.unbindProxyEvents(o)};a.prototype.onerror=function(o){this.confirm(false,"onerror");this.unbindProxyEvents(o)};a.prototype.confirm=function(o,p){this.isConfirmed=true;this.isLoaded=o;this.emit("confirm",this,p)};a.prototype.unbindProxyEvents=function(o){l.unbind(o.target,"load",this);l.unbind(o.target,"error",this)};return f});(function(){(function(c){var d,b,a;a=function(e){var f;f=window.location.protocol+"//"+window.location.host;if(e.substr(0,f.length)===f){e=e.substr(f.length)}return e};d=function(e,f){debug.assert(e.substr(0,5)==="http:"||e.substr(0,6)==="https:"||e.substr(0,1)==="/");if(e.substr(0,1)==="/"){e=window.location.protocol+"//"+window.location.host+e}return e};c.fn.pjax=function(e){return this.livequery("click",function(i){var j,h,g,f;if(!c.support.pjax){return}h=c(this);f=h.attr("href");if(f===void 0){return}if(f==="#"){return i.preventDefault()}f=a(f);if(f.substr(0,1)!=="/"){return}g=f.indexOf("#");if(g===0){return}if(g>0&&window.location.pathname+window.location.search===f.substr(0,g)){return}if(h.attr("target")!==void 0){return}if(h.attr("rel")!==void 0){return}if(h.data("pjax")===false){return}if(i.which>1||i.metaKey||i.shiftKey||i.ctrlKey){return}i.preventDefault();j={url:f,containers:h.data("pjax")};return c.pjax(c.extend({},j,e))})};b=c.pjax=function(e){var f,h,g;e=e||{};e.url=c.isFunction(e.url)?e.url():e.url;e.url=e.url||window.location.pathname+window.location.search;e.url=a(e.url);if(e.url.substr(0,1)!=="/"){return window.location.replace(e.url)}if(!(c.support.pjax||e.force)){return window.location.replace(e.url)}if(!e.containers){e.containers=["body"]}e=c.extend(true,{},b.defaults,e);e.context=c(document.body);h=e.success||c.noop;delete e.success;e.success=function(l){var m,i,j,k,n;j=c("<div/>").html(l);n=c.trim(j.find("title").text()||"");if(n){setTimeout(function(){c("title").text(n);return document.title=n},1)}c.each(e.containers,function(p,o){var q,r;q=j.find(o);if(!(q.length>0)){return window.location.replace(e.url)}r=c(o);q.insertAfter(r);return r.remove()});i=d(e.url,e.data);if(e.pop){debug.assert(window.location.href===i)}if(!e.pop&&c.support.pjax){k={containers:e.containers};if(window.location.href!==i){window.history.pushState(k,n,i);debug.debug("pjax.pushstate",n,i)}else{window.history.replaceState(k,n,i);debug.debug("pjax.replacestate",n,i)}}m=window.location.hash.toString();if(m!==""&&e.top===void 0){window.location.href=m;setTimeout(function(){window.location.href=m;return c(window).trigger("scroll")},1)}else{if(e.top!==void 0){c("html, body").scrollTop(e.top||0);setTimeout(function(){c("html, body").scrollTop(e.top||0);return c(window).trigger("scroll")},1)}}h.apply(this,arguments);this.trigger("pjax:complete")};if(!e.pop&&c.support.pjax){f={containers:e.containers,top:c(window).scrollTop()};window.history.replaceState(f,document.title,window.location.href);debug.debug("pjax.replacestate",document.title,window.location.href)}g=b.xhr;if(g&&g.readyState<4){g.onreadystatechange=c.noop;g.abort()}b.options=e;b.xhr=c.ajax(e);return b.xhr};b.defaults={timeout:21000,force:false,pop:false,top:0,type:"GET",data:{},dataType:"html",containers:["body"],url:function(){return window.location.pathname+window.location.search},beforeSend:function(e){return this.trigger("pjax:start",[e,b.options])},error:function(g,f,e){if(f!=="abort"){return window.location=b.options.url}},complete:function(e){return this.trigger("pjax:end",[e,b.options])}};b.initial="state" in window.history?false:true;c(window).bind("popstate",function(f){if(b.initial){return b.initial=false}if(!f.state){return}debug.debug("pjax.popstate",window.location.href,f.state);return c.pjax({url:window.location.href,containers:f.state.containers,top:f.state.top,pop:true})});if(c.inArray("state",c.event.props)<0){c.event.props.push("state")}return c.support.pjax=window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]|WebApps\/.+CFNetwork)/)})(jQuery)}).call(this);(function(){(function(c){var a,b,e,d;c.autotimestamp={timer:null,options:{}};c.autotimestamp.defaults={interval:30000,gettext:function(f){return f}};a=function(i,g){var f,k,j,h;h=i.getFullYear();j=i.getMonth()+1;f=i.getDate();if(j<10){j="0"+j}if(f<10){f="0"+f}if(h===(new Date()).getFullYear()){k=g.gettext("%m/%d")}else{k=g.gettext("%Y/%m/%d")}return k.replace(/%Y/g,h).replace(/%m/g,j).replace(/%d/g,f)};b=function(i,g){var j,f,h;f=i.getHours();h=i.getMinutes();if(f<10){f="0"+f}if(h<10){h="0"+h}j=g.gettext("%H:%M");return j.replace(/%H/g,f).replace(/%M/g,h)};e=function(h,g){var i,f;f=new Date();i=Math.floor((f.getTime()-h.getTime())/(1000*60));if(i<-10){return a(h,g)}if(i<1){return g.gettext("Just now")}if(i<5){return g.gettext("Few minutes ago")}if(i<60){return g.gettext("%d minutes ago").replace(/%d/g,i)}i=Math.floor(i/60);if(i===1){return g.gettext("An hour ago")}if(i<9){return g.gettext("%d hours ago").replace(/%d/g,i)}if(Math.abs(i)<24&&f.getDay()===h.getDay()){return g.gettext("Today at %s").replace(/%s/g,b(h,g))}if(Math.abs(i)<48&&f.getDay()===(h.getDay()+1)%7){return g.gettext("Yesterday at %s").replace(/%s/g,b(h,g))}return a(h,g)};d=function(g){var f,h;f=c.extend({},c.autotimestamp.defaults,c.autotimestamp.options);h=new Date(parseInt(g.data("timestamp"))*1000);g.find("span").text(e(h,f));g.data("autotimestamp",true).attr("data-autotimestamp","true");if(c.autotimestamp.timer){return}return c.autotimestamp.timer=setInterval(function(){return c("*[data-autotimestamp]").each(function(){return d(c(this))})},f.interval)};return c.fn.autotimestamp=function(f){c.autotimestamp.options=f||{};return this.livequery(function(){var g,h;g=c(this);d(g);h=new Date(parseInt(c(this).data("timestamp"))*1000);return g.attr("title",h.toLocaleDateString()+" "+h.toLocaleTimeString())})}})(jQuery)}).call(this);(function(){var a=[].slice;(function(c){var b;b=function(i,d,f){var l,j,g,k,h,e;if(arguments.length<3){h=[c].concat(a.call(arguments)),i=h[0],d=h[1],f=h[2]}j=i;e=d.split(".");for(g=0,k=e.length;g<k;g++){l=e[g];i=i[l]||(i[l]={})}return f(i,j)};return b("applysquare",function(d,f){var e;d.namespace=b;e=[];d.init=function(g){return e.push(g)};return d.run=function(){var j,i,h,g;g=[];for(i=0,h=e.length;i<h;i++){j=e[i];g.push(j())}return g}})})(window);$(function(){if(window.location.search==="?debug"){debug.setLevel(9)}return applysquare.run()});applysquare.namespace("applysquare.settings",function(b){return applysquare.init(function(){$("div.js-settings div").each(function(){var c,d;c=$(this).data("key");d=$(this).data("value");if(!c){return}b[c]=d;if(c==="DEBUG"&&d){debug.setLevel(9)}return debug.info("applysquare.settings."+c,d)});return $("div.js-settings").remove()})});$(function(){var b;$.pjax.defaults.success=function(){return applysquare.run()};$("a").pjax({containers:["#base"]});$(".js-autotimestamp").autotimestamp();b=null;$(document.body).bind("pjax:start",function(){clearTimeout(b);return b=setTimeout(function(){clearTimeout(b);b=null;return $("div.js-loading").addClass("progress-striped active")},1)});return $(document.body).bind("pjax:end",function(){clearTimeout(b);return b=setTimeout(function(){clearTimeout(b);b=null;return $("div.js-loading").removeClass("progress-striped active")},1000)})})}).call(this);(function(){applysquare.namespace("applysquare.utils",function(b){var a,g,e,d,c,f;d=function(i,h){h=$.extend({url:i,dataType:"script",cache:true},h);return $.ajax(h)};a=function(h){if(!h){return}if(!window.ga){window.GoogleAnalyticsObject="ga";window.ga=window.ga||function(){return(window.ga.q=window.ga.q||[]).push(arguments)};window.ga.l=1*new Date();window.ga("create",h,"applysquare.net");d("//www.google-analytics.com/analytics.js")}return window.ga("send","pageview",{page:location.pathname+location.search+location.hash,location:location.href})};c=function(){var h;h=$(this);window.disqus_shortname="applysquare";window.disqus_identifier=h.data("id");window.disqus_url=h.data("url");window.disqus_title=h.data("title");window.disqus_config=function(){return this.language=h.data("language")};if(window.DISQUS){window.DISQUS.reset({reload:true});return}return d("//applysquare.disqus.com/embed.js")};g=null;e=null;f=function(){var i,h,j;if(g||e){return}i=$(this);j=i.data("id");h=i.data("file");g=document.write;e=document.writeln;document.write=function(k){return i.append(k)};document.writeln=function(k){return i.append(k+"\n")};return d("https://gist.github.com/"+j+".js",{data:{file:h},complete:function(){document.write=g;document.writeln=e;g=null;return e=null}})};return applysquare.init(function(){a(applysquare.settings.ANALYTICS);$("div.js-disqus").each(c);return $("div.js-gist").each(f)})})}).call(this);(function(){applysquare.namespace("applysquare.language",function(a){return applysquare.init(function(){var b,c;c=navigator.userLanguage||navigator.language||"en";c=c.split("-")[0].toLowerCase();if(c!=="zh"){c="en"}b=$(document.body);$("*[lang]",b).addClass("hide");return $('*[lang="'+c+'"]',b).removeClass("hide")})})}).call(this);(function(){applysquare.namespace("applysquare.cover",function(a){var b;b=function(){var d,f,e,c;f=$(this);d=f.find("> div:first");e=d.find("> img");c=d.height();debug.debug("applysquare.cover.background.initial",c);return d.imagesLoaded(function(){var h,g;g=$(window).scrollTop();e.removeClass("collapsed");if($(window).width()<768){return}h=d.height()-c;debug.debug("applysquare.cover.background.diff",h);if(!(h>0)){return}return $("html,body").scrollTop(g+h)})};return applysquare.init(function(){return $(".js-cover").each(b)})})}).call(this);(function(){applysquare.namespace("applysquare.post",function(a){var b;b=function(){var d,c;c=$(this);d=c.find("section.js-post-content");return $.each(d.find("a"),function(){return $(this).attr({target:"_blank"})})};return applysquare.init(function(){return $("article.js-post").each(b)})})}).call(this);